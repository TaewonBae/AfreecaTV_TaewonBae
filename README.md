# AfreecaTV-Î∞∞ÌÉúÏõê
- [ÏïÑÌîÑÎ¶¨Ïπ¥TV Open API]Î•º ÏÇ¨Ïö©ÌïòÏó¨ Î∞©ÏÜ° Î¶¨Ïä§Ìä∏Î•º Ï°∞ÌöåÌïòÍ≥† Ïπ¥ÌÖåÍ≥†Î¶¨Î°ú ÌïÑÌÑ∞ÎßÅÌï† Ïàò ÏûàÎäî Ïñ¥ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏûÖÎãàÎã§.
- Î¶¨Ïä§Ìä∏ÏóêÏÑú Î∞©ÏÜ°ÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Î∞©ÏÜ° ÏÉÅÏÑ∏ Ï†ïÎ≥¥Î•º ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.


![001](https://user-images.githubusercontent.com/43931412/211161982-5d581f41-b1d2-44e6-b799-090aa9f58060.png)

## LanchScreen & MainScreen
- Î°úÎî©ÌôîÎ©¥Í≥º ÎÇòÎ®∏ÏßÄ ÌôîÎ©¥ÏûÖÎãàÎã§.
- MainControllerÏóê UITabBarControllerÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Ìôà, Í≤åÏûÑ, VOD, MY(Ï¶êÍ≤®Ï∞æÍ∏∞), ÎçîÎ≥¥Í∏∞(ÏÑ§Ï†ï) 5Í∞ÄÏßÄ ÌôîÎ©¥ÏùÑ Íµ¨ÏÑ±ÌñàÏäµÎãàÎã§.
![002](https://user-images.githubusercontent.com/43931412/211161986-0d09f9b6-39c9-44a5-9603-8d5583b5978c.png)

## Ìôà & Í≤åÏûÑ
- Ìôà & Í≤åÏûÑ ÌôîÎ©¥ÏùÄ TableviewÏôÄ tableviewcellÎ°ú Íµ¨ÏÑ±ÎêòÏñ¥ÏûàÏúºÎ©∞, cellÏùò UI Ïª¥Ìè¨ÎÑåÌä∏Îäî label, imageviewÏù¥Î©∞, Ìï¥Îãπ Ïª¥Ìè¨ÎÑåÌä∏Îì§ÏùÄ (Î∞©ÏÜ° Ï†úÎ™©, BJÎãâÎÑ§ÏûÑ, Î∞©ÏÜ° Ïç∏ÎÑ§Ïùº Ïù¥ÎØ∏ÏßÄ, BJÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ, ÏãúÏ≤≠Ïûê Ïàò)Î•º ÌëúÏãúÌï¥Ï§çÎãàÎã§.
- ÏÉÅÎã® NavigationBarÏùò Ïò§Î•∏Ï™ΩÏóêÏûàÎäî Î©îÎâ¥Î•º ÏÑ†ÌÉùÌïòÎ©¥ Ïπ¥ÌÖåÍ≥†Î¶¨ Î¶¨Ïä§Ìä∏Î•º Î∂àÎü¨Ïò¨ Ïàò ÏûàÎèÑÎ°ù AlertControllerÎ•º ÌÜµÌï¥ Î©îÎâ¥Î•º Íµ¨ÏÑ±ÌïòÏòÄÏúºÎ©∞, Ìôà Ïπ¥ÌÖåÍ≥†Î¶¨ÏóêÏÑúÎäî (Ï†ÑÏ≤¥Î∞©ÏÜ°, ÌÜ†ÌÅ¨/Ï∫†Î∞©, Î®πÎ∞©/Ïø°Î∞©), Í≤åÏûÑ Ïπ¥ÌÖåÍ≥†Î¶¨ÏóêÏÑúÎäî (Í≤åÏûÑ Ï†ÑÏ≤¥, LOL, Î∞∞ÌãÄÍ∑∏ÎùºÏö¥Îìú, ÌîºÌååÏò®ÎùºÏù∏4, ÏÑúÎì†Ïñ¥ÌÉù)ÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏûàÏäµÎãàÎã§.
![003](https://user-images.githubusercontent.com/43931412/211161992-2a849572-5c83-43a0-8133-d3b19bf73fff.png)
![004](https://user-images.githubusercontent.com/43931412/211161999-7bf078a6-007a-4ce4-8349-c89b44df13c5.png)
### 1. Ïπ¥ÌÖåÍ≥†Î¶¨Î≥ÑÎ°ú url Ï†ÑÏó≠Î≥ÄÏàò ÏÑ§Ï†ï
- urlÏùÄ AfreecaURL ÌÅ¥ÎûòÏä§Ïóê Ïñ¥ÎîîÏóêÏÑúÎÇò Ï†ëÍ∑ºÌï† Ïàò ÏûàÎèÑÎ°ù Ïπ¥ÌÖåÍ≥†Î¶¨ Î≥ÑÎ°ú Ï†ÑÏó≠ Î≥ÄÏàòÎ•º ÏÑ§Ï†ïÌñàÏäµÎãàÎã§. (Ïπ¥ÌÖåÍ≥†Î¶¨Î≥ÑÎ°ú 'select_vaule'ÏùÑ Îã§Î•¥Í≤å ÏÑ§Ï†ï)
```swift
class AfreecaURL {
    public static var gameURL = "https://openapi.afreecatv.com/broad/list?client_id=af_mobilelab_dev_e0f147f6c034776add2142b425e81777&select_key=cate&select_value=00040000&order_type=view_cnt&page_no=1" // Ï†ÑÏ≤¥ 0, Í≤åÏûÑ00040000
}
```

### 2. Íµ¨Ï°∞Ï≤¥ ÏÑ†Ïñ∏
- JSON ÌååÏã±ÏùÑ ÏâΩÍ≤å ÌïòÍ∏∞ ÏúÑÌïú BroadDataÌòï Íµ¨Ï°∞Ï≤¥ ÏÑ†Ïñ∏Ìï¥Ï§çÎãàÎã§. -> Codable ÌîÑÎ°úÌÜ†ÏΩú Ï§ÄÏàò / Tree ÌòïÌÉú : Objecct > broad > [broad_title, broad_thumb,,,,]
```swift
struct BroadData : Codable{
    let broad : [Broad] //Î∞∞Ïó¥Î°ú ÎêòÏñ¥ÏûàÏñ¥ÏÑú Î∞∞Ïó¥Î°ú ÏÑ†Ïñ∏
    let total_cnt : Int
}

struct Broad : Codable{
    let broad_title : String// Î∞©ÏÜ° Ï†úÎ™©
    let broad_thumb : String // Î∞©ÏÜç Ïç∏ÎÑ§Ïùº 480*720
    let user_nick : String // BJ ÎãâÎÑ§ÏûÑ
    let profile_img : String // BJ ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ
    let total_view_cnt : String // Ï¥ù ÏãúÏ≤≠Ïûê Ïàò
    let broad_start : String // Î∞©ÏÜ° ÏãúÏûë ÏãúÍ∞Ñ
    let broad_grade : String // Î∞©ÏÜ° Îì±Í∏â
    let broad_bps : String // Î∞©ÏÜ° ÌôîÏßà
    let broad_resolution : String // Î∞©ÏÜ° Ìï¥ÏÉÅÎèÑ
}
```

### 3.URL Ïó∞Í≤∞ Î∞è Data Pasing & Decoding
- URL Ïó∞Í≤∞ÏùÑ ÏúÑÌïú getDataÌï®Ïàò
- getData Ìï®ÏàòÎäî urlÏùÑ stringÌòïÏúºÎ°ú Î∞õÍ∏∞ÏúÑÌï¥ string typeÏùò parameterÎ•º Í∞ÄÏßëÎãàÎã§.(parameterÏóêÎäî ÏúÑÏóê ÏÑ§Ï†ïÌïú Ï†ÑÏó≠ Î≥ÄÏàòÎ•º ÎÑ£Ïñ¥Ï§çÎãàÎã§.)
- getData Ìï®Ïàò ÏïàÏóêÏÑúÎäî parameterÎ°ú Î∞õÏùÄ Ï£ºÏÜåÎ•º urlÌòïÌÉúÎ°ú Î∞îÍøîÏ§Ä Îí§ URL SessionÏùÑ ÎßåÎì§Í≥† URL Session Ïù∏Ïä§ÌÑ¥Ïä§ÏóêÍ≤å task(data, header, errorÏ≤òÎ¶¨)Î•º Ìï†ÎãπÌï©ÎãàÎã§.
- Json DataÏóê dataÎ•º ÎÑ£Ïñ¥Ï£ºÍ≥† JSON Í∞ùÏ≤¥ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖÏùò Ïù∏Ïä§ÌÑ¥Ïä§Î•º ÎîîÏΩîÎî©Ìï¥Ï§çÎãàÎã§.  (do ~ try catchÎ°ú ÏóêÎü¨ Ï≤òÎ¶¨)
- tableviewÎ•º reload Ìï† Îïå DispatchQueueÎ•º ÌÜµÌï¥ Main ThreadÍ∞Ä ÏïÑÎãå Î≥ÑÎèÑÏùò ThreadÏóêÏÑú Ï≤òÎ¶¨Ìïú Îí§ Main ThreadÎ°ú Í≤∞Í≥ºÎßåÏùÑ Ï†ÑÎã¨ÌïòÏó¨ ÌôîÎ©¥Ïóê ÌëúÏãúÌï©ÎãàÎã§.
```swift
//MARK: - URL Ïó∞Í≤∞ Î∞è Data Decode
func getData(url: String){
    // 1. URL 
    if let url = URL(string: url){
        // 2. URL Session 
        let session = URLSession(configuration: .default)
        // 3. URL Session dataTask 
        let task = session.dataTask(with: url) { (data, response, error) in
            // ÏóêÎü¨Í∞Ä ÎÇ¨ÏùÑÍ≤ΩÏö∞ ÏóêÎü¨Î©îÏãúÏßÄ Ï∂úÎ†•ÌõÑ Ï¢ÖÎ£å
            if error != nil{
                print(error!)
                return
            }
            //Json dataÏóê data ÎÑ£Í∏∞
            if let JSONdata = data {
                //print(JSONdata, response!)//Î™á byte ÏôîÎäîÏßÄ, responseÏùò Ï†ïÎ≥¥ Ï∂úÎ†•
                //let dataString = String(data: JSONdata, encoding: .utf8)
                //print(dataString!) //JSON data Ï∂úÎ†•
                //JSON Í∞ùÏ≤¥ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖÏùò Ïù∏Ïä§ÌÑ¥Ïä§Î•º ÎîîÏΩîÎî© + do ~ try catchÎ°ú ÏóêÎü¨ Ï≤òÎ¶¨
                let decoder = JSONDecoder()
                do {
                    let decodedData = try decoder.decode(BroadData.self, from: JSONdata)
                    self.broadData = decodedData
                    DispatchQueue.main.async {
                        self.home_tableview.reloadData() //cell ÏóÖÎç∞Ïù¥Ìä∏   
                    }
                }catch{
                    print(error)
                }
            }
        }
        task.resume()
    }
}
```
### 4. TableView Cell ÏÑ∏ÌåÖ
- ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏Ïò® Îç∞Ïù¥ÌÑ∞Î•º cellÏóê ÏÑ∏ÌåÖÌï¥Ï§çÎãàÎã§.
- Î∞©ÏÜ°Ï†úÎ™©, BJÎãâÎÑ§ÏûÑ, Ï¥ù ÏãúÏ≤≠Ïûê ÏàòÎäî label textÏóê dataÎ•º ÎÑ£Ïñ¥Ï§ÄÎã§.
- BJÌîÑÎ°úÌïÑ Î∞è Ïç∏ÎÑ§Ïùº Ïù¥ÎØ∏ÏßÄÎ•º cellÏóê Ìï†ÎãπÌïòÍ∏∞ÏúÑÌï¥ Î∞õÏïÑÏò® Optional dataÎ•º string typeÎ°ú Î∞îÍæº ÌõÑ URL ÌòïÌÉúÎ°ú Î∞îÍøîÏ§ÄÎã§.(üìçÏ£ºÏùò)
- Ïó¨Í∏∞ÍπåÏßÄ Ìï† Í≤ΩÏö∞ cell ÏÑ∏ÌåÖÏù¥ ÏôÑÎ£åÎêòÎÇò, Î¶¨Ïä§Ìä∏Î•º Î∂àÎü¨Ïò§Î©¥ ÏÉÅÎãπÌûà Ïò§ÎûúÏãúÍ∞ÑÏù¥ Í±∏Î¶º.
- UIImageview downloaded Î©îÏÜåÎìúÎäî Î∞ëÏóê ÏÑ§Î™Ö
```swift
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    
    
    let cell = home_tableview.dequeueReusableCell(withIdentifier: "home_tableviewcell", for: indexPath) as! HomeTableViewCell
    // cellÏóê text, image ÏÑ§Ï†ï
    cell.title.text = broadData?.broad[indexPath.row].broad_title
    cell.nick.text = broadData?.broad[indexPath.row].user_nick
    cell.view_cnt.text = broadData?.broad[indexPath.row].total_view_cnt
    //cell Ïù¥ÎØ∏ÏßÄ corner ÏÑ§Ï†ï 480 * 270 >> imageview 16:9
    cell.profile.layer.masksToBounds = true
    cell.profile.layer.cornerRadius = cell.profile.bounds.width/2
    cell.thumb.layer.masksToBounds = true
    cell.thumb.layer.cornerRadius = 10
    // BJ ÌîÑÎ°úÌïÑ, Ïç∏ÎÑ§Ïùº Ïù¥ÎØ∏ÏßÄ cellÏóê Ìï†Îãπ
    DispatchQueue.main.async { [self] in
        //optional data >> string >> url
        if let profile_str = broadData?.broad[indexPath.row].profile_img
        {
            let profile_str2 = "https:" + profile_str
            if let profile_url = NSURL(string:profile_str2)
            {
                cell.profile.downloaded(from: profile_url as URL)
                
            }
        }
        if let thumb_str = broadData?.broad[indexPath.row].broad_thumb
        {
            let thumb_str2 = "https:" + thumb_str
            if let thumb_url = NSURL(string:thumb_str2)
            {
                cell.thumb.downloaded(from: thumb_url as URL)
            }
        }
        
    }
    
    return cell
}
```


- ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏Ïò® 
![005](https://user-images.githubusercontent.com/43931412/211162001-ec67d9c3-4b00-41f6-b77c-8aa5fa79996f.png)


```swift
import UIKit
class MainController: UITabBarController{
    override func viewDidLoad() {
        super.viewDidLoad()
    }
}
```

## Í∞úÎ∞ú ÌôòÍ≤Ω

- Ïñ∏Ïñ¥ : swift
- xcode : 14.2
- Deployment Target : iOS15

## API (ÏïÑÌîÑÎ¶¨Ïπ¥TV OpenAPI)

https://developers.afreecatv.com/?szWork=openapi
